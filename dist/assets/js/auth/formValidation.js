import{sendMessageToAT}from"../abstracts/accessbility.js";const regularExpressions={username:/^(?=.*[a-zA-Z])(?=.*[0-9])[a-zA-Z0-9]+$/,password:/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{6,16}$/,email:/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/};export const errorMsgs={emptyInput:"This field must not be empty",username:"Username must contain at least one letter and one number, e.g. user123",password:"Password must be in the range of 6 to 16 characters.              It must also contain at least one letter, one number and one special character, e.g. @userpass123",passwordsMatch:"Password and password confirmation don't match",email:"Invalid email pattern."};export function validateFormData(e){const t=e.querySelectorAll("input:not(:is([type='file'], [type='checkbox'])), textarea");for(let e of t){let t=e.closest(".c-input-group"),s=e.hasAttribute("data-not-required"),n=e.dataset.validationKey,r=e.value;if(s)continue;if(""===r)return void handleInvalidInput(e,t,"emptyInput");const a=regularExpressions[n];if(a&&!a.test(r))return void handleInvalidInput(e,t,n);t.classList.remove("js-not-valid")}return!0}function handleInvalidInput(e,t,s){e.focus();const n=errorMsgs[s];function r(){t.classList.remove("js-not-valid"),document.removeEventListener("click",r)}t.style.setProperty("--errorMessage",JSON.stringify(n)),t.classList.add("js-not-valid"),setTimeout((()=>{sendMessageToAT(`\n      invalid       ${"emptyInput"===s?"Input":s}:       ${n}\n      `,!0)}),100),setTimeout((()=>document.addEventListener("click",r)))}export function createErrorMessage(e){let t=document.querySelector(".js-error-msg");function s(){t.classList.remove("js-show-up")}t?t.querySelector("p").textContent=e:(t=document.createElement("p"),t.className="c-error-message js-error-msg",t.innerHTML=`\n    <button type="button">\n      <i class="bi bi-x" aria-hidden="true"></i>\n      <span class="u-sr-only">\n        close popup message\n      </span>\n    </button>\n    <p>\n      ${e}\n    </p>\n    `,t.querySelector("button").addEventListener("click",s),document.body.prepend(t)),sendMessageToAT("Sorry, "+e,!0),setTimeout((()=>t.classList.add("js-show-up")),100),setTimeout(s,4e3)}