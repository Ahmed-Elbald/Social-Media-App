import"./abstracts/accessbility.js";import{logout}from"./auth/authorization.js";import{addFillersText,toggleDropdonw}from"./abstracts/helpers.js";import{createLightbox}from"./components/popups.js";import{changeFontsize,defaultFontSize,togglePageTheme}from"./abstracts/styles.js";import{getUserImg}from"./markup/posts.js";function handleRouting(){currentUserData?(0===getCurrentPath()&&window.location.assign("./home.html"),handleLoginState()):1===getCurrentPath()&&window.location.assign("./login.html")}function getCurrentPath(){return"/login.html"===pagePathName||"/index.html"===pagePathName||"/"===pagePathName?0:1}function handleLoginState(){const e="/home.html"===pagePathName?currentUserData.name.substr(0,currentUserData.name.indexOf(" ")):currentUserData.name;addCurrentUserImg(),addFillersText(document,{name:e,username:currentUserData.username,email:currentUserData.email}),document.getElementById("logout-btn").addEventListener("click",logout)}function handleDocumentClickEvent(e){const t=e.target,a=t.classList;a.contains("js-dropdown-toggler")?toggleDropdonw.call(t):a.contains("js-lightbox-opener")&&createLightbox.call(t)}function applyPreferedSettings(){localStorage.getItem("postItUserPreferences")||localStorage.setItem("postItUserPreferences",JSON.stringify({fontSize:defaultFontSize,darkTheme:window.matchMedia("(prefers-color-scheme: dark)").matches})),togglePageTheme(),changeFontsize()}function addCurrentUserImg(){if(currentUserData){const e=getUserImg(currentUserData,""),t=document.querySelectorAll(".js-current-user-img");for(let a of t)a.appendChild(e.cloneNode(!0))}}window.pagePathName=window.location.pathname.match(/(?<!^)\/.*/)?window.location.pathname.match(/(?<!^)\/.*/)[0]:window.location.pathname,window.currentUserData=JSON.parse(localStorage.getItem("postItUserData")),handleRouting(),applyPreferedSettings(),document.addEventListener("click",handleDocumentClickEvent);